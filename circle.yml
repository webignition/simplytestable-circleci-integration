machine:
  php:
    version: 5.5.36

dependencies:
  cache_directories:
    - ~/.composer/cache

  override:
    # Check out worker repo
    - git clone git@github.com:webignition/worker.simplytestable.com.git
    # Create app and bundle config
    - cp config/worker.simplytestable.com/app_config.yml worker.simplytestable.com/app/config/config.yml
    - cp worker.simplytestable.com/app/config/security_credentials.yml.dist worker.simplytestable.com/app/config/security_credentials.yml
    - cat config/worker.simplytestable.com/bundle_parameters.yml config/worker.simplytestable.com/bundle_parameters.hydrogen > worker.simplytestable.com/src/SimplyTestable/WorkerBundle/Resources/config/parameters.yml
    # Create database and database user
    - mysql -u ubuntu < config/worker.simplytestable.com/createdb.sql
    # Install
    - composer install:
        pwd: worker.simplytestable.com
test:
  override:
    - echo foo
